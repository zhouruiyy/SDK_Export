===========================================
Mac SDK æµ‹è¯•å‘½ä»¤
===========================================

ğŸ“¦ æµ‹è¯• SDK: Agora_Native_SDK_for_Mac_rel.v4.4.30_25321_FULL_20250820_1052_846534.zip
ğŸ”— SDK URL: http://10.80.1.174:8090/agora_sdk/4.4.30/nightly_build/2025-08-20/mac/full/Agora_Native_SDK_for_Mac_rel.v4.4.30_25321_FULL_20250820_1052_846534.zip

===========================================
æ–¹å¼ä¸€ï¼šå®Œæ•´æµ‹è¯•ï¼ˆæ¨èï¼‰
===========================================

cd /Volumes/ZR/Agora/Jenkins

# æ¸…ç†æ—§çš„æ„å»º
rm -rf build_test_mac

# è¿è¡Œæµ‹è¯•
./scripts/local_test_mac.sh \
  "http://10.80.1.174:8090/agora_sdk/4.4.30/nightly_build/2025-08-20/mac/full/Agora_Native_SDK_for_Mac_rel.v4.4.30_25321_FULL_20250820_1052_846534.zip" \
  "4.4.30"

===========================================
æ–¹å¼äºŒï¼šåˆ†æ­¥æµ‹è¯•ï¼ˆç”¨äºè°ƒè¯•ï¼‰
===========================================

cd /Volumes/ZR/Agora/Jenkins

# 1. æ¸…ç†ç¯å¢ƒ
rm -rf build_test_mac
mkdir -p build_test_mac/original_sdk

# 2. ä¸‹è½½ SDK
curl -L -o build_test_mac/original_sdk.zip \
  "http://10.80.1.174:8090/agora_sdk/4.4.30/nightly_build/2025-08-20/mac/full/Agora_Native_SDK_for_Mac_rel.v4.4.30_25321_FULL_20250820_1052_846534.zip"

# 3. è§£å‹ SDK
unzip -q build_test_mac/original_sdk.zip -d build_test_mac/original_sdk

# 4. æŸ¥çœ‹ç›®å½•ç»“æ„
ls -lh build_test_mac/original_sdk/
find build_test_mac/original_sdk -name "libs" -type d

# 5. å¤„ç† SDK
bash scripts/process_sdk_mac.sh \
  build_test_mac/original_sdk \
  extra_resources \
  scripts/framework_to_dylib.py

# 6. æ£€æŸ¥ç”Ÿæˆçš„ agora_sdk ç›®å½•
ls -lh build_test_mac/original_sdk/agora_sdk/
echo "dylib æ–‡ä»¶æ•°é‡:"
ls -1 build_test_mac/original_sdk/agora_sdk/*.dylib | wc -l

# 7. æ‰“åŒ… SDK
bash scripts/package_sdk_mac.sh \
  build_test_mac/original_sdk \
  Agora_Native_SDK_for_Mac_rel.v4.4.30_25321_FULL_20250820_1052_846534.zip

# 8. æŸ¥çœ‹æœ€ç»ˆç»“æœ
ls -lh build_test_mac/original_sdk/*.zip*

===========================================
éªŒè¯ç»“æœ
===========================================

# 1. æ£€æŸ¥ç”Ÿæˆçš„æ–‡ä»¶å
ls -lh build_test_mac/agora_sdk_mac_*.zip

# é¢„æœŸæ–‡ä»¶åï¼š
# agora_sdk_mac_v4.4.30_25321_FULL_20250820_1052_846534.zip

# 2. æ£€æŸ¥ ZIP å†…å®¹
unzip -l build_test_mac/agora_sdk_mac_v4.4.30_25321_FULL_20250820_1052_846534.zip | head -30

# 3. éªŒè¯ dylib æ–‡ä»¶
echo "=== æ‰€æœ‰ dylib æ–‡ä»¶ ==="
unzip -l build_test_mac/agora_sdk_mac_v4.4.30_25321_FULL_20250820_1052_846534.zip | grep "\.dylib"

# 4. éªŒè¯ RTM åº“æ–‡ä»¶
echo "=== RTM ç›¸å…³æ–‡ä»¶ ==="
unzip -l build_test_mac/agora_sdk_mac_v4.4.30_25321_FULL_20250820_1052_846534.zip | grep -E '(rtm|uap_aed)'

# 5. æŸ¥çœ‹ MD5
cat build_test_mac/agora_sdk_mac_v4.4.30_25321_FULL_20250820_1052_846534.zip.md5

# 6. æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š
cat build_test_mac/test_report.txt

===========================================
å‡†å¤‡ RTM åº“æ–‡ä»¶
===========================================

# å¦‚æœè¿˜æ²¡æœ‰å‡†å¤‡ Mac çš„ RTM åº“æ–‡ä»¶ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

cd /Volumes/ZR/Agora/Jenkins/extra_resources

# åˆ›å»º libs_mac ç›®å½•
mkdir -p libs_mac

# å¤åˆ¶ Mac çš„ dylib æ–‡ä»¶ï¼ˆéœ€è¦æ›¿æ¢ä¸ºå®é™…è·¯å¾„ï¼‰
# cp /path/to/libagora_rtm_sdk_c.dylib libs_mac/
# cp /path/to/libAgoraRtmKit.dylib libs_mac/
# cp /path/to/libuap_aed.dylib libs_mac/

# éªŒè¯æ–‡ä»¶
ls -lh libs_mac/

===========================================
æ–‡ä»¶åæ ¼å¼è¯´æ˜
===========================================

åŸå§‹æ–‡ä»¶åï¼š
  Agora_Native_SDK_for_Mac_rel.v4.4.30_25321_FULL_20250820_1052_846534.zip

æå–ç‰ˆæœ¬éƒ¨åˆ†ï¼ˆv åé¢åˆ° .zip å‰ï¼‰ï¼š
  v4.4.30_25321_FULL_20250820_1052_846534

ç”Ÿæˆæ–°æ–‡ä»¶åï¼š
  agora_sdk_mac_v4.4.30_25321_FULL_20250820_1052_846534.zip

è§„åˆ™ï¼š
  agora_sdk_mac_{våé¢çš„æ‰€æœ‰å­—ç¬¦}.zip

===========================================
å¸¸è§é—®é¢˜
===========================================

é—®é¢˜1: æ‰¾ä¸åˆ° libs ç›®å½•
è§£å†³: æ£€æŸ¥è§£å‹åçš„ç›®å½•ç»“æ„
  find build_test_mac/original_sdk -name "libs" -type d

é—®é¢˜2: Python è„šæœ¬å¤±è´¥
è§£å†³: 
  - æ£€æŸ¥æ˜¯å¦å®‰è£…äº† python3
  - æ£€æŸ¥è„šæœ¬è·¯å¾„æ˜¯å¦æ­£ç¡®
  python3 --version

é—®é¢˜3: æ‰¾ä¸åˆ° RTM dylib æ–‡ä»¶
è§£å†³: 
  - æ£€æŸ¥ extra_resources/libs_mac/ ç›®å½•
  - ç¡®ä¿ 3 ä¸ª dylib æ–‡ä»¶éƒ½å­˜åœ¨
  ls -lh extra_resources/libs_mac/

é—®é¢˜4: æ–‡ä»¶åæ ¼å¼ä¸å¯¹
è§£å†³: 
  - æ£€æŸ¥åŸå§‹æ–‡ä»¶åæ˜¯å¦åŒ…å« .v
  - æŸ¥çœ‹ scripts/package_sdk_mac.sh ä¸­çš„ generate_mac_sdk_name å‡½æ•°

===========================================

